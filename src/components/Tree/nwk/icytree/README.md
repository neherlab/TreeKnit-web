Taken with modifications from https://github.com/tgvaughan/icytree
(commit e205440117eb463e92aecaf76790598ac7013585)

Courtesy of Tim Vaughan (https://github.com/tgvaughan)

